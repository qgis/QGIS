/************************************************************************
 * This file has been generated automatically from                      *
 *                                                                      *
 * src/core/mesh/qgsmesheditor.h                                        *
 *                                                                      *
 * Do not edit manually ! Edit header and run scripts/sipify.py again   *
 ************************************************************************/





class QgsMeshEditingError
{
%Docstring(signature="appended")
Represents an error which occurred during mesh editing.

.. versionadded:: 3.22
%End

%TypeHeaderCode
#include "qgsmesheditor.h"
%End
  public:
    QgsMeshEditingError();
%Docstring
Constructor of the default error, that is NoError
%End

    QgsMeshEditingError( Qgis::MeshEditingErrorType type, int elementIndex );
%Docstring
Constructor with eht error ``type`` and the index of the element
``elementIndex``
%End

    Qgis::MeshEditingErrorType errorType;

    int elementIndex;

    bool operator==( const QgsMeshEditingError &other ) const;
    bool operator!=( const QgsMeshEditingError &other ) const;
};

class QgsMeshEditor : QObject
{
%Docstring(signature="appended")
Handles edit operations on a mesh layer.

.. versionadded:: 3.22
%End

%TypeHeaderCode
#include "qgsmesheditor.h"
%End
  public:
    QgsMeshEditor( QgsMeshLayer *meshLayer );
%Docstring
Constructor with a specified layer ``meshLayer``
%End

    QgsMeshEditor( QgsMesh *nativeMesh, QgsTriangularMesh *triangularMesh, QObject *parent = 0 );
%Docstring
Constructor with a specific mesh ``nativeMesh`` and an associated
triangular mesh ``triangularMesh``
%End


    std::unique_ptr< QgsMeshDatasetGroup > createZValueDatasetGroup();
%Docstring
Creates and returns a scalar dataset group with value on vertex that is
can be used to access the Z value of the edited mesh. The caller takes
ownership.

.. warning::

   This is dangerous API to call -- the caller takes ownership of the returned object, but this object
   MUST exist for the lifetime of the editor. Use with extreme caution.
%End

    QgsMeshEditingError initialize();
%Docstring
Initializes the mesh editor and returns first error if the internal
native mesh has topological errors
%End

    QgsMeshEditingError initializeWithErrorsFix();
%Docstring
Initializes the mesh editor. If topological errors occur,tries to fix
these errors and returns error if there is one that couldn't be fixed

.. versionadded:: 3.28
%End

    bool fixError( const QgsMeshEditingError &error );
%Docstring
Tries to fix the topological ``error`` in the mesh. Returns ``False`` if
the fix fails

.. versionadded:: 3.28
%End

    void resetTriangularMesh( QgsTriangularMesh *triangularMesh );
%Docstring
Resets the triangular mesh
%End
    bool
%Docstring
Returns ``True`` if a ``face`` can be added to the mesh

.. note::

   All vertices related to this face must be already in the mesh.
%End
      faceCanBeAdded( const QgsMeshFace &face ) const;

    bool faceCanBeAddedWithNewVertices( const QList<int> &verticesIndex, const QList<QgsMeshVertex> &newVertices ) const;
%Docstring
Returns ``True`` if a face formed by some vertices can be added to the
mesh. The vertices are defined by ``verticesIndex`` that contains the
index of already existing vertices or the value -1 if the vertex is not
existing for now in the mesh. The positions of new vertices are stored
in ``newVertices`` sorted by their positions in the face.

.. versionadded:: 3.30
%End
    bool
%Docstring
Returns ``True`` if the face does not intersect or contains any other
elements (faces or vertices) The topological compatibility is not
checked
%End
      isFaceGeometricallyCompatible( const QgsMeshFace &face ) const;

    QgsMeshEditingError addFaces( const QVector<QgsMeshFace> &faces );
%Docstring
Adds faces ``faces`` to the mesh, returns topological errors if this
operation fails (operation is not realized)
%End
    QgsMeshEditingError addFace( const QVector<int> &vertexIndexes );
%Docstring
Adds a face ``face`` to the mesh with vertex indexes ``vertexIndexes``,
returns topological errors if this operation fails (operation is not
realized)
%End

    QgsMeshEditingError addFaceWithNewVertices( const QList<int> &vertexIndexes, const QList<QgsMeshVertex> &newVertices );
%Docstring
Adds a face formed by some vertices ``vertexIndexes`` to the mesh,
returns topological errors if this operation fails (operation is not
realized) The vertices are defined by ``verticesIndex`` that contains
the index of already existing vertices or the value -1 if the vertex is
not existing for now in the mesh. The positions of new vertices are
stored in ``newVertices`` sorted by their positions in the face.

.. versionadded:: 3.30
%End
    QgsMeshEditingError removeFaces( const QList<int> &facesToRemove );
%Docstring
Removes faces ``faces`` to the mesh, returns topological errors if this
operation fails (operation is not realized)
%End

    bool edgeCanBeFlipped( int vertexIndex1, int vertexIndex2 ) const;
%Docstring
Returns ``True`` if the edge can be flipped (only available for edge
shared by two faces with 3 vertices)
%End

    void flipEdge( int vertexIndex1, int vertexIndex2 );
%Docstring
Flips edge (``vertexIndex1``, ``vertexIndex2``)
%End

    bool canBeMerged( int vertexIndex1, int vertexIndex2 ) const;
%Docstring
Returns ``True`` if faces separated by vertices with indexes
``vertexIndex1`` and ``vertexIndex2`` can be merged
%End

    void merge( int vertexIndex1, int vertexIndex2 );
%Docstring
Merges faces separated by vertices with indexes ``vertexIndex1`` and
``vertexIndex2``
%End

    bool faceCanBeSplit( int faceIndex ) const;
%Docstring
Returns ``True`` if face with index ``faceIndex`` can be split
%End

    int splitFaces( const QList<int> &faceIndexes );
%Docstring
Splits faces with index ``faceIndexes``. Only faces that can be split
are split. Returns the count of faces effictively split
%End

    int addVertices( const QVector<QgsMeshVertex> &vertices, double tolerance );
%Docstring
Adds vertices in triangular mesh coordinate in the mesh. Vertex is
effectivly added if the transform from triangular coordinate to layer
coordinate succeeds or if any vertices are next the added vertex (under
``tolerance`` distance). The method returns the number of vertices
effectivly added.

.. note::

   this operation remove including face if exists and replace it by new faces surrounding the vertex
   if the mesh hasn't topological error before this operation, the toological operation always succeed.
%End
    int
%Docstring
Adds points as vertices in triangular mesh coordinate in the mesh.
Vertex is effectivly added if the transform from triangular coordinate
to layer coordinate succeeds or if any vertices are next the added
vertex (under ``tolerance`` distance). The method returns the number of
vertices effectivly added.

.. note::

   this operation remove including face if exists and replace it by new faces surrounding the vertex
   if the mesh hasn't topological error before this operation, the toological operation always succeed
%End
      addPointsAsVertices( const QVector<QgsPoint> &point, double tolerance );

    QgsMeshEditingError removeVerticesWithoutFillHoles( const QList<int> &verticesToRemoveIndexes );
%Docstring
Removes vertices with indexes in the list ``verticesToRemoveIndexes`` in
the mesh removing the surrounding faces without filling the freed space.

If removing these vertices leads to a topological errors, the method
will return the corresponding error and the operation is canceled
%End

    QList<int> removeVerticesFillHoles( const QList<int> &verticesToRemoveIndexes );
%Docstring
Removes vertices with indexes in the list ``verticesToRemoveIndexes`` in
the mesh the surrounding faces AND fills the freed space.

This operation fills holes by a Delaunay triangulation using the
surrounding vertices. Some vertices could no be deleted to avoid
topological error even with hole filling (can not be detected before
execution). A list of the remaining vertex indexes is returned.
%End

    void changeZValues( const QList<int> &verticesIndexes, const QList<double> &newValues );
%Docstring
Changes the Z values of the vertices with indexes in ``vertices``
indexes with the values in ``newValues``
%End

    bool canBeTransformed( const QList<int> &facesToCheck, const std::function<const QgsMeshVertex( int )> &transformFunction ) const;
%Docstring
Returns ``True`` if faces with index in ``transformedFaces`` can be
transformed without obtaining topologic or geometrical errors
considering the transform function ``transformFunction``

The transform function takes a vertex index in parameter and return a
:py:class:`QgsMeshVertex` object with transformed coordinates. This
transformation is done in layer coordinates

.. note::

   Even only the faces with indexes in ``facesToCheck`` are checked to avoid testing all the mesh,
   all the mesh are supposed to path through this transform function (but it is possible that transform function is not able to transform all vertices).
   Moving free vertices of the mesh is also checked.
%End
    void
%Docstring
Changes the (X,Y) coordinates values of the vertices with indexes in
``verticesIndexes`` with the values in ``newValues``. The caller has the
responsibility to check if changing the vertices coordinates does not
lead to topological errors. New values are in layer CRS.
%End
      changeXYValues( const QList<int> &verticesIndexes, const QList<QgsPointXY> &newValues );

    void changeCoordinates( const QList<int> &verticesIndexes, const QList<QgsPoint> &newCoordinates );
%Docstring
Changes the (X,Y,Z) coordinates values of the vertices with indexes in
``vertices`` indexes with the values in ``newValues``. The caller has
the responsibility to check if changing the vertices coordinates does
not lead to topological errors New coordinates are in layer CRS.
%End

    void advancedEdit( QgsMeshAdvancedEditing *editing );
%Docstring
Applies an advance editing on the edited mesh, see
:py:class:`QgsMeshAdvancedEditing`
%End

    void stopEditing();
%Docstring
Stops editing
%End

    QgsRectangle extent() const;
%Docstring
Returns the extent of the edited mesh
%End

    bool isModified() const;
%Docstring
Returns whether the mesh has been modified
%End

    bool reindex( bool renumbering );
%Docstring
Reindexes the mesh, that is remove unusued index of face and vertices,
this operation void the undo/redo stack.

If ``renumbering`` is true, a renumbering is operated to optimize the
vertices indexes.

Returns ``False`` if the operation fail.
%End


    QList<int> freeVerticesIndexes() const;
%Docstring
Returns all the free vertices indexes
%End

    bool isVertexOnBoundary( int vertexIndex ) const;
%Docstring
Returns whether the vertex with index ``vertexIndex`` is on a boundary
%End

    bool isVertexFree( int vertexIndex ) const;
%Docstring
Returns whether the vertex with index ``vertexIndex`` is a free vertex
%End

    QgsMeshVertexCirculator vertexCirculator( int vertexIndex ) const;
%Docstring
Returns a vertex circulator linked to this mesh around the vertex with
index ``vertexIndex``. If the vertex does not exist or is a free vertex,
the cirxulator is invalid. If :py:func:`~QgsMeshEditor.stopEditing` is
called, circulator created before and new circulator are valid and must
not be used. It is recommended to destruct all circulator created before
calling any edit methods or :py:func:`~QgsMeshEditor.stopEditing` to
save memory usage. Calling :py:func:`~QgsMeshEditor.initialize` allows
creation of new circulator after :py:func:`~QgsMeshEditor.stopEditing`
is called.
%End
    QgsTopologicalMesh &topologicalMesh();
%Docstring
Returns a reference to the topological mesh
%End
    QgsTriangularMesh *triangularMesh();
%Docstring
Returns a pointer to the triangular mesh
%End
    bool checkConsistency( QgsMeshEditingError &error ) const;
%Docstring
Return ``True`` if the edited mesh is consistent
%End

    bool edgeIsClose( QgsPointXY point, double tolerance, int &faceIndex, int &edgePosition );
%Docstring
Returns ``True`` if an edge of face is closest than the tolerance from
the ``point`` in triangular mesh coordinate Returns also the face index
and the edge position in ``faceIndex`` and ``edgePosition``
%End

    int validFacesCount() const;
%Docstring
Returns the count of valid faces, that is non void faces in the mesh
%End

    int validVerticesCount() const;
%Docstring
Returns the count of valid vertices, that is non void vertices in the
mesh
%End

    int maximumVerticesPerFace() const;
%Docstring
Returns the maximum count of vertices per face that the mesh can support
%End

    void addVertexWithDelaunayRefinement( const QgsMeshVertex &vertex, const double tolerance );
%Docstring
Add a vertex in a face with Delaunay refinement of neighboring faces All
neighboring faces sharing a vertex will be refined to satisfy the
Delaunay condition

.. versionadded:: 3.42
%End

  signals:
    void meshEdited();
%Docstring
Emitted when the mesh is edited
%End

};


/************************************************************************
 * This file has been generated automatically from                      *
 *                                                                      *
 * src/core/mesh/qgsmesheditor.h                                        *
 *                                                                      *
 * Do not edit manually ! Edit header and run scripts/sipify.py again   *
 ************************************************************************/
